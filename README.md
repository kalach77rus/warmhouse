# Project_template

# Задание 1. Анализ и планирование

### 1. Описание функциональности монолитного приложения

**Управление отоплением:**

- Пользователи могут удалённо включать/выключать отопление в своих домах.
- Система поддерживает добавления датчиков температуры, их активировацию / деактивировацию.

**Мониторинг температуры:**

- Система получает данные о температуре с датчиков, установленных в домах. 
- Пользователи могут просматривать текущую температуру в своих домах через веб-интерфейс.

### 2. Анализ архитектуры монолитного приложения

Язык программирования: Go
База данных: PostgreSQL
Архитектура: Монолитная, все компоненты системы (обработка запросов, бизнес-логика, работа с данными) находятся в рамках одного приложения.
Взаимодействие: Синхронное, запросы обрабатываются последовательно.
Масштабируемость: Ограничена, так как монолит сложно масштабировать по частям.
Развертывание: Требует остановки всего приложения.

### 3. Определение доменов и границы контекстов

- Управление устройствами отопления
- Управление устройствами освещения
- СКУД
- Взаимодействие с реле
- WEB-сервер для внешнего доступа
- Администрирование пользователей
- Сценарии автоматизации

### **4. Проблемы монолитного решения**

- Сложность горизонтального масштабирования: при росте нагрузки сложно выделить и масштабировать только нагруженные компоненты. В данном случае это, например, частое взаимодействие с датчиками температуры, и редкое взаимодействие с другими запланированными по тендеру устройствами.
- Сложность тестирования: модульное тестирование затруднено из-за сильной связанности компонентов
- Рискованные деплои: любое обновление затрагивает всю систему
- Зависимости версий: сложно обновлять отдельные компоненты без влияния на всю систему
- Ограничения в технологиях: сложно использовать разные технологии для разных задач. Например, если для определённого датчика потребуется сторонняя библиотека, которую трудно использовать в текущей архитектуре системы на GO.
- Сложность изоляции: трудно изолировать критические компоненты от злоумышленников. Атаковав сервер, злоумышленник атакует всю системы целиком.
- Проблемы с доступом: сложно реализовать гранулярную политику доступа
- Высокие затраты на поддержку: увеличение сложности системы ведёт к росту затрат на поддержку системы. Уже сейчас для настройки системы у клиента нужен специалист. 

### 5. Визуализация контекста системы — диаграмма С4

[Диаграмма контекста C4](docs/c4/context_previous.puml)

# Задание 2. Проектирование микросервисной архитектуры

**Диаграмма контейнеров (Containers)**

[Диаграмма контейнеров C4](docs/c4/container.puml)

**Диаграмма компонентов (Components)**

[Диаграмма "WEB-сервер для внешнего доступа" C4](docs/c4/component/front_server.puml)
[Диаграмма "Администрирование пользователей" C4](docs/c4/component/user_managment.puml)
[Диаграмма "Сценарии автоматизации" C4](docs/c4/component/automation.puml)
[Диаграмма "Проксирование запросов к устройствам и статистика" C4](docs/c4/component/telemetry.puml)
[Диаграмма "Управление устройствами отопления" C4](docs/c4/component/devices_warm.puml)
[Диаграмма "Управление устройствами освещения" C4](docs/c4/component/devices_light.puml)
[Диаграмма "СКУД" C4](docs/c4/component/pacs.puml)
[Диаграмма "Взаимодействие с реле" C4](docs/c4/component/relay.puml)

**Диаграмма кода (Code)**

[Диаграмма "Сценарии автоматизации" C4](docs/c4/code/user_managment.puml)

# Задание 3. Разработка ER-диаграммы

[ER-диаграмма](docs/entities.puml)

# Задание 4. Создание и документирование API

### 1. Тип API

Я выбрал REST API, потому что:
- Работает на любом устройстве и платформе
- Использует стандартные HTTP-методы
- Гибкое масштабирование компонентов
- Отсутствие состояния между запросами
- Простое тестирование API
- Стандартизированная система ошибок
- Простая поддержка системы

### 2. Документация API

[Документацию API для "Администрирование пользователей"](schemas/UserService.postman_collection.json)

# Задание 5. Работа с docker и docker-compose

1) Сделал приложение на Python

2) Упаковал в Docker и добавил в docker-compose. Порт по умолчанию 8081

3) Попрвил настройки docker-compose для запуска postgres


# **Задание 6. Разработка MVP**

Сделал два примера микросервиса:
- [Микросервис "Администрирование пользователей"](apps/user_service/Dockerfile)
- [Микросервис "Взаимодействие с реле"](apps/gateway_api/Dockerfile)