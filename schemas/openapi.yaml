openapi: 3.0.3
info:
    title: WarmHouse User API (Shared)
    description: Shared API endpoints for WarmHouse system
    version: 1.0.0
servers:
    - url: http://localhost:8080/api/v1
      description: Локальный сервер разработки
    - url: https://api.warmhouse.com/v1
      description: Продакшн сервер
tags:
    - name: Auth
      description: Аутентификация и регистрация пользователей
paths:
    /internal/defaultuser:
        get:
            tags:
                - Auth
            summary: Получить ID пользователя по умолчанию
            description: Возвращает UUID пользователя по умолчанию для тестирования
            operationId: getDefaultUser
            parameters:
                - $ref: '#/components/parameters/ApiKeyHeader'
            responses:
                '200':
                    description: Полная информация о пользователе по умолчанию
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/DefaultUserResponse'
                            example:
                                user:
                                    id: "550e8400-e29b-41d4-a716-446655440000"
                                    name: "Иван Петров"
                                    email: "ivan@example.com"
                                    phone: "+7 (999) 123-45-67"
                                    created_at: "2024-01-15T10:30:00Z"
                                    updated_at: "2024-01-15T10:30:00Z"
                '403':
                    description: Доступ запрещен
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/ErrorResponse'
                            example:
                                error: "access_denied"
                                message: "Доступ запрещен"
                '500':
                    description: Внутренняя ошибка сервера
                    content:
                        application/json:
                            schema:
                                $ref: '#/components/schemas/ErrorResponse'
                            example:
                                error: "internal_error"
                                message: "Внутренняя ошибка сервера"

components:
    parameters:
        ApiKeyHeader:
            name: X-Api-Key
            in: header
            required: true
            description: API ключ для идентификации
            schema:
                type: string
                example: "salalalal"

    schemas:
        ErrorResponse:
            type: object
            required:
                - error
                - message
            properties:
                error:
                    type: string
                    description: Код ошибки
                    example: "validation_error"
                message:
                    type: string
                    description: Описание ошибки
                    example: "Некорректные данные"
                details:
                    type: array
                    items:
                        type: object
                        properties:
                            field:
                                type: string
                                description: Поле с ошибкой
                            message:
                                type: string
                                description: Сообщение об ошибке
                    description: Детали ошибок валидации
            additionalProperties: false

        User:
            type: object
            required:
                - id
                - name
                - email
                - created_at
                - updated_at
            properties:
                id:
                    type: string
                    format: uuid
                    description: Уникальный идентификатор пользователя
                    example: "550e8400-e29b-41d4-a716-446655440000"
                name:
                    type: string
                    description: Имя пользователя
                    example: "Иван Петров"
                email:
                    type: string
                    description: Email адрес пользователя
                    example: "ivan@example.com"
                phone:
                    type: string
                    description: Номер телефона пользователя
                    example: "+7 (999) 123-45-67"
                created_at:
                    type: string
                    format: date-time
                    description: Дата и время создания пользователя
                    example: "2024-01-15T10:30:00Z"
                updated_at:
                    type: string
                    format: date-time
                    description: Дата и время последнего обновления пользователя
                    example: "2024-01-15T10:30:00Z"
            additionalProperties: false

        DefaultUserResponse:
            type: object
            required:
                - user
                - default_house_id
            properties:
                user:
                    $ref: '#/components/schemas/User'
                default_house_id:
                    type: string
                    format: uuid
                    description: UUID самого давнего дома пользователя
                    example: "550e8400-e29b-41d4-a716-446655440000"
            additionalProperties: false
